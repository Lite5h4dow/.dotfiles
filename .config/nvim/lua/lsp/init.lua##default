--lsp zero
local lsp=require('lsp-zero')
lsp.preset("recommended")
lsp.nvim_workspace()
lsp.setup()

-- lsp install
local lsp_installer = require("nvim-lsp-installer")

lsp_installer.settings({
  install_root_dir = string.gsub((vim.fn.system("echo $HOME") .. "/.config/nvim/.lsp_servers"), "\n", "")
})

lsp_installer.on_server_ready(function(server)
  local opts={
    on_attach = require("lsp.handlers").on_attach,
    capabilities = require("lsp.handlers").capabilities
  }
  
  local opts_exist, server_opts = pcall(require, "lsp.settings.".. server.name)
  if opts_exist then
    opts = vim.tbl_deep_extend("force", server_opts, opts)
  end
  server:setup(opts)
end
)
